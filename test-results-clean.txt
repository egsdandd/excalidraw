yarn run v1.22.22
$ vitest --run

 RUN  v3.0.6 E:/excalidraw

 ✓ packages/element/tests/textWrapping.test.ts (47 tests) 23ms
stderr | packages/excalidraw/data/transform.test.ts > Test Transform > Test arrow bindings > should bind arrows to existing elements if ids are correct
No element for end binding with id rect-11 found

 ✓ packages/excalidraw/data/transform.test.ts (18 tests) 27ms
(node:21440) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:612) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:16312) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:18084) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:11224) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:17356) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:19920) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:15464) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:5880) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:4412) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:11648) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:2340) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:8960) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:18896) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:24168) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:20724) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:17420) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:23092) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:21100) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:16392) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:14320) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:20844) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:20712) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:20772) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:1904) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:20888) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:7480) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
 ❯ packages/excalidraw/components/Stats/stats.test.tsx (19 tests | 17 failed) 13ms
   ✓ step sized value > should return edge values correctly
   ✓ step sized value > step sized value lies in the middle
   × binding with linear elements > should remain bound to linear element on small position change 5ms
     → localStorage.clear is not a function
   × binding with linear elements > should unbind linear element on large position change 1ms
     → localStorage.clear is not a function
   × stats for a generic element > should open stats 0ms
     → localStorage.clear is not a function
   × stats for a generic element > should be able to edit all properties for a general element 0ms
     → localStorage.clear is not a function
   × stats for a generic element > should keep only two decimal places 0ms
     → localStorage.clear is not a function
   × stats for a generic element > should update input x and y when angle is changed 0ms
     → localStorage.clear is not a function
   × stats for a generic element > should fix top left corner when width or height is changed 0ms
     → localStorage.clear is not a function
   × stats for a non-generic element > text element 0ms
     → localStorage.clear is not a function
   × stats for a non-generic element > frame element 0ms
     → localStorage.clear is not a function
   × stats for a non-generic element > image element 0ms
     → localStorage.clear is not a function
   × stats for a non-generic element > should display fontSize for bound text 0ms
     → localStorage.clear is not a function
   × stats for multiple elements > should display MIXED for elements with different values 0ms
     → localStorage.clear is not a function
   × stats for multiple elements > should display a property when one of the elements is editable for that property 0ms
     → localStorage.clear is not a function
   × stats for multiple elements > should treat groups as single units 0ms
     → localStorage.clear is not a function
   × frame resizing behavior > should add shapes to frame when resizing frame to encompass them 0ms
     → localStorage.clear is not a function
   × frame resizing behavior > should add multiple shapes when frame encompasses them through height resize 0ms
     → localStorage.clear is not a function
   × frame resizing behavior > should not affect shapes that remain outside frame after resize 0ms
     → localStorage.clear is not a function
 ❯ packages/element/tests/linearElementEditor.test.tsx (42 tests | 41 failed | 1 skipped) 16ms
   × Test Linear Elements > should normalize the element points at creation 6ms
     → localStorage.clear is not a function
   × Test Linear Elements > should not drag line and add midpoint until dragged beyond a threshold 1ms
     → localStorage.clear is not a function
   × Test Linear Elements > should allow dragging line from midpoint in 2 pointer lines outside editor 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > should allow entering and exiting line editor via context menu 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > should enter line editor via enter (line) 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > should enter line editor via ctrl+enter (line) 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > should enter line editor via ctrl+enter (arrow) 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > should enter line editor on ctrl+dblclick (simple arrow) 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > should enter line editor on ctrl+dblclick (line) 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > should enter line editor on dblclick (line) 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > should not enter line editor on dblclick (arrow) 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > shouldn't create text element on double click in line editor (arrow) 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > Inside editor > should not drag line and add midpoint when dragged irrespective of threshold 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > Inside editor > should allow dragging line from midpoint in 2 pointer lines 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > Inside editor > should update the midpoints when element roundness changed 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > Inside editor > should update all the midpoints when element position changed 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > Inside editor > in-editor dragging a line point covered by another element 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > Inside editor > When edges are round > should allow dragging lines from midpoints in between segments 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > Inside editor > When edges are round > should update only the first segment midpoint when its point is dragged 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > Inside editor > When edges are round > should hide midpoints in the segment when points moved close 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > Inside editor > When edges are round > should remove the midpoint when one of the points in the segment is deleted 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > Inside editor > When edges are round > should allow dragging lines from midpoints in between segments 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > Inside editor > When edges are round > should update all the midpoints when its point is dragged 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > Inside editor > When edges are round > should hide midpoints in the segment when points moved close 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > Inside editor > When edges are round > should update all the midpoints when a point is deleted 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > Test bound text element > should match styles for text editor 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > Test bound text element > should bind text to arrow when double clicked 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > Test bound text element > should bind text to arrow when clicked on arrow and enter pressed 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > Test bound text element > should not bind text to line when double clicked 0ms
     → localStorage.clear is not a function
   ↓ Test Linear Elements > Test bound text element > should not rotate the bound text and update position of bound text and bounding box correctly when arrow rotated
   × Test Linear Elements > Test bound text element > should resize and position the bound text and bounding box correctly when 3 pointer arrow element resized 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > Test bound text element > should resize and position the bound text correctly when 2 pointer linear element resized 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > Test bound text element > should not render vertical align tool when element selected 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > Test bound text element > should wrap the bound text when arrow bound container moves 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > Test bound text element > should not render horizontal align tool when element selected 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > Test bound text element > should update label coords when a label binded via context menu is unbinded 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > Test bound text element > should not update label position when arrow dragged 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > Test bound text element > Test getBoundTextElementPosition > should return correct position for 2 pointer arrow 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > Test bound text element > Test getBoundTextElementPosition > should return correct position for arrow with odd points 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > Test bound text element > Test getBoundTextElementPosition > should return correct position for arrow with even points 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > Test moving linear element points > should move the endpoint in the negative direction correctly when the start point is also moved in the positive direction 0ms
     → localStorage.clear is not a function
   × Test Linear Elements > Test moving linear element points > should preserve original angle when dragging endpoint with SHIFT key 0ms
     → localStorage.clear is not a function
 ✓ packages/element/tests/delta.test.tsx (14 tests) 11ms
 ✓ packages/element/tests/textElement.test.ts (28 tests) 12ms
 ✓ packages/excalidraw/tests/data/restore.test.ts (40 tests) 30ms
 ❯ packages/excalidraw/tests/lasso.test.tsx (6 tests | 6 failed) 10ms
   × Basic lasso selection tests > None should be selected 7ms
     → localStorage.clear is not a function
   × Basic lasso selection tests > Intersects some, does not enclose/intersect the rest 1ms
     → localStorage.clear is not a function
   × Basic lasso selection tests > Intersects some and encloses some 0ms
     → localStorage.clear is not a function
   × Basic lasso selection tests > Single linear element 0ms
     → localStorage.clear is not a function
   × Special cases > Select only frame if its children are also selected 0ms
     → localStorage.clear is not a function
   × Special cases > Selects group if any group from group is selected 0ms
     → localStorage.clear is not a function
 ❯ packages/element/tests/flowchart.test.tsx (7 tests | 7 failed) 9ms
   × flow chart creation > create multiple successor nodes at once 5ms
     → localStorage.clear is not a function
   × flow chart creation > when directions are changed, only the last same directions will apply 0ms
     → localStorage.clear is not a function
   × flow chart creation > when escaped, no nodes will be created 0ms
     → localStorage.clear is not a function
   × flow chart creation > create nodes one at a time 0ms
     → localStorage.clear is not a function
   × flow chart navigation > single node at each level 0ms
     → localStorage.clear is not a function
   × flow chart navigation > multiple nodes at each level 0ms
     → localStorage.clear is not a function
   × flow chart navigation > take the most obvious link when possible 0ms
     → localStorage.clear is not a function
 ❯ packages/excalidraw/tests/dragCreate.test.tsx (10 tests | 10 failed) 9ms
   × Test dragCreate > add element to the scene when pointer dragging long enough > rectangle 5ms
     → localStorage.clear is not a function
   × Test dragCreate > add element to the scene when pointer dragging long enough > ellipse 0ms
     → localStorage.clear is not a function
   × Test dragCreate > add element to the scene when pointer dragging long enough > diamond 0ms
     → localStorage.clear is not a function
   × Test dragCreate > add element to the scene when pointer dragging long enough > arrow 0ms
     → localStorage.clear is not a function
   × Test dragCreate > add element to the scene when pointer dragging long enough > line 0ms
     → localStorage.clear is not a function
   × Test dragCreate > do not add element to the scene if size is too small > rectangle 0ms
     → localStorage.clear is not a function
   × Test dragCreate > do not add element to the scene if size is too small > ellipse 0ms
     → localStorage.clear is not a function
   × Test dragCreate > do not add element to the scene if size is too small > diamond 0ms
     → localStorage.clear is not a function
   × Test dragCreate > do not add element to the scene if size is too small > arrow 0ms
     → localStorage.clear is not a function
   × Test dragCreate > do not add element to the scene if size is too small > line 0ms
     → localStorage.clear is not a function
 ❯ packages/excalidraw/tests/selection.test.tsx (15 tests | 15 failed) 10ms
   × box-selection > should allow adding to selection via box-select when holding shift 5ms
     → localStorage.clear is not a function
   × box-selection > should (de)select element when box-selecting over and out while not holding shift 0ms
     → localStorage.clear is not a function
   × inner box-selection > selecting elements visually nested inside another 0ms
     → localStorage.clear is not a function
   × inner box-selection > selecting grouped elements visually nested inside another 0ms
     → localStorage.clear is not a function
   × inner box-selection > selecting & deselecting grouped elements visually nested inside another 0ms
     → localStorage.clear is not a function
   × selection element > create selection element on pointer down 0ms
     → localStorage.clear is not a function
   × selection element > resize selection element on pointer move 0ms
     → localStorage.clear is not a function
   × selection element > remove selection element on pointer up 0ms
     → localStorage.clear is not a function
   × select single element on the scene > rectangle 0ms
     → localStorage.clear is not a function
   × select single element on the scene > diamond 0ms
     → localStorage.clear is not a function
   × select single element on the scene > ellipse 0ms
     → localStorage.clear is not a function
   × select single element on the scene > arrow 0ms
     → localStorage.clear is not a function
   × select single element on the scene > arrow escape 0ms
     → localStorage.clear is not a function
   × tool locking & selection > should not select newly created element while tool is locked 0ms
     → localStorage.clear is not a function
   × selectedElementIds stability > box-selection should be stable when not changing selection 0ms
     → localStorage.clear is not a function
 ❯ packages/excalidraw/tests/regressionTests.test.tsx (51 tests | 51 failed) 29ms
   × given element A and group of elements B and given both are selected when user clicks on B, on pointer up only elements from B should be selected 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × given element A and group of elements B and given both are selected when user shift-clicks on B, on pointer up only element A should be selected 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > draw every type of shape 7ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > click to select a shape 1ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > key 2 selects rectangle tool 1ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > key r selects rectangle tool 1ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > key 3 selects diamond tool 1ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > key d selects diamond tool 1ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > key 4 selects ellipse tool 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > key o selects ellipse tool 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > key 5 selects arrow tool 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > key a selects arrow tool 1ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > key 6 selects line tool 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > key l selects line tool 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > key 7 selects freedraw tool 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > key p selects freedraw tool 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > change the properties of a shape 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > click on an element and drag it 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > alt-drag duplicates an element 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > click-drag to select a group 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > shift-click to multiselect, then drag 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > pinch-to-zoom works 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > two-finger scroll works 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > spacebar + drag scrolls the canvas 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > arrow keys 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > undo/redo drawing an element 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > noop interaction after undo shouldn't create history entry 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > zoom hotkeys 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > make a group and duplicate it 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > should group elements and ungroup them 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > double click to edit a group 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > adjusts z order when grouping 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > supports nested groups 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > updates fontSize & fontFamily appState 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > deselects selected element, on pointer up, when click hits element bounding box but doesn't hit the element 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > switches selected element on pointer down 1ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > can drag element that covers another element, while another elem is selected 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > deselects selected element on pointer down when pointer doesn't hit any element 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > Drags selected element when hitting only bounding box and keeps element selected 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > given selected element A with lower z-index than unselected element B and given B is partially over A when clicking intersection between A and B B should be selected on pointer up 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > given selected element A with lower z-index than unselected element B and given B is partially over A when dragging on intersection between A and B A should be dragged and keep being selected 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > deselects group of selected elements on pointer down when pointer doesn't hit any element 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > switches from group of selected elements to another element on pointer down 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > deselects group of selected elements on pointer up when pointer hits common bounding box without hitting any element 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > drags selected elements from point inside common bounding box that doesn't hit any element and keeps elements selected after dragging 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > given a group of selected elements with an element that is not selected inside the group common bounding box when element that is not selected is clicked should switch selection to not selected element on pointer up 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > given a selected element A and a not selected element B with higher z-index than A and given B partially overlaps A when there's a shift-click on the overlapped section B is added to the selection 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > shift click on selected element should deselect it on pointer up 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > single-clicking on a subgroup of a selected group should not alter selection 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > deleting last but one element in editing group should unselect the group 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × regression tests > Cmd/Ctrl-click exclusively select element under pointer 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
 ❯ packages/element/tests/cropElement.test.tsx (11 tests | 11 failed) 10ms
   × Enter and leave the crop editor > enter the editor by double clicking 5ms
     → localStorage.clear is not a function
   × Enter and leave the crop editor > enter the editor by pressing enter 0ms
     → localStorage.clear is not a function
   × Enter and leave the crop editor > leave the editor by clicking outside 1ms
     → localStorage.clear is not a function
   × Enter and leave the crop editor > leave the editor by pressing escape 0ms
     → localStorage.clear is not a function
   × Crop an image > Cropping changes the dimension 0ms
     → localStorage.clear is not a function
   × Crop an image > Cropping has minimal sizes 0ms
     → localStorage.clear is not a function
   × Crop an image > Preserve aspect ratio 0ms
     → localStorage.clear is not a function
   × Cropping and other features > Cropping works independently of duplication 0ms
     → localStorage.clear is not a function
   × Cropping and other features > Resizing should not affect crop 0ms
     → localStorage.clear is not a function
   × Cropping and other features > Flipping does not change crop 0ms
     → localStorage.clear is not a function
   × Cropping and other features > Exports should preserve crops 0ms
     → localStorage.clear is not a function
 ❯ packages/excalidraw/tests/contextmenu.test.tsx (17 tests | 17 failed) 16ms
   × contextMenu element > shows context menu for canvas 6ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × contextMenu element > shows context menu for element 1ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × contextMenu element > shows context menu for element 1ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × contextMenu element > shows 'Group selection' in context menu for multiple selected elements 1ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × contextMenu element > shows 'Ungroup selection' in context menu for group inside selected elements 1ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × contextMenu element > selecting 'Copy styles' in context menu copies styles 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × contextMenu element > selecting 'Paste styles' in context menu pastes styles 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × contextMenu element > selecting 'Delete' in context menu deletes element 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × contextMenu element > selecting 'Add to library' in context menu adds element to library 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × contextMenu element > selecting 'Duplicate' in context menu duplicates element 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × contextMenu element > selecting 'Send backward' in context menu sends element backward 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × contextMenu element > selecting 'Bring forward' in context menu brings element forward 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × contextMenu element > selecting 'Send to back' in context menu sends element to back 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × contextMenu element > selecting 'Bring to front' in context menu brings element to front 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × contextMenu element > selecting 'Group selection' in context menu groups selected elements 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × contextMenu element > selecting 'Ungroup selection' in context menu ungroups selected group 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
   × contextMenu element > right-clicking on a group should select whole group 0ms
     → localStorage.clear is not a function
     → Cannot read properties of undefined (reading 'length')
 ❯ packages/element/tests/zindex.test.tsx (13 tests | 13 failed) 10ms
   × z-index manipulation > send back 6ms
     → localStorage.clear is not a function
   × z-index manipulation > bring forward 0ms
     → localStorage.clear is not a function
   × z-index manipulation > bring to front 0ms
     → localStorage.clear is not a function
   × z-index manipulation > send to back 0ms
     → localStorage.clear is not a function
   × z-index manipulation > duplicating elements should retain zindex integrity 0ms
     → localStorage.clear is not a function
   × z-index manipulation > duplicating incorrectly interleaved elements (group elements should be together) should still produce reasonable result 0ms
     → localStorage.clear is not a function
   × z-index manipulation > group-selected duplication should includes deleted elements that weren't selected on account of being deleted 0ms
     → localStorage.clear is not a function
   × z-index manipulation > text-container binding should be atomic 0ms
     → localStorage.clear is not a function
   × z-indexing with frames > moving whole frame by one (normalized) 0ms
     → localStorage.clear is not a function
   × z-indexing with frames > moving whole frame by one (DENORMALIZED) 0ms
     → localStorage.clear is not a function
   × z-indexing with frames > moving selected frame children by one (normalized) 0ms
     → localStorage.clear is not a function
   × z-indexing with frames > moving selected frame children by one (DENORMALIZED) 0ms
     → localStorage.clear is not a function
   × z-indexing with frames > moving whole frame to front/end 0ms
     → localStorage.clear is not a function
 ❯ packages/element/tests/resize.test.tsx (55 tests | 53 failed | 2 skipped) 20ms
   × generic element > resizes with locked aspect ratio 0ms
     → localStorage.clear is not a function
   × generic element > resizes from center 0ms
     → localStorage.clear is not a function
   × generic element > resizes with a label 0ms
     → localStorage.clear is not a function
   × generic element > resizes > with handle 'n' 6ms
     → localStorage.clear is not a function
   × generic element > resizes > with handle 'e' 1ms
     → localStorage.clear is not a function
   × generic element > resizes > with handle 's' 0ms
     → localStorage.clear is not a function
   × generic element > resizes > with handle 'w' 0ms
     → localStorage.clear is not a function
   × generic element > resizes > with handle 'ne' 0ms
     → localStorage.clear is not a function
   × generic element > resizes > with handle 'se' 0ms
     → localStorage.clear is not a function
   × generic element > resizes > with handle 'sw' 0ms
     → localStorage.clear is not a function
   × generic element > resizes > with handle 'nw' 0ms
     → localStorage.clear is not a function
   × generic element > flips while resizing > with handle 'n' 0ms
     → localStorage.clear is not a function
   × generic element > flips while resizing > with handle 'e' 0ms
     → localStorage.clear is not a function
   × generic element > flips while resizing > with handle 's' 0ms
     → localStorage.clear is not a function
   × generic element > flips while resizing > with handle 'w' 0ms
     → localStorage.clear is not a function
   × generic element > flips while resizing > with handle 'ne' 0ms
     → localStorage.clear is not a function
   × generic element > flips while resizing > with handle 'se' 0ms
     → localStorage.clear is not a function
   × generic element > flips while resizing > with handle 'sw' 0ms
     → localStorage.clear is not a function
   × generic element > flips while resizing > with handle 'nw' 0ms
     → localStorage.clear is not a function
   × line element > resizes 0ms
     → localStorage.clear is not a function
   × line element > flips while resizing 0ms
     → localStorage.clear is not a function
   × line element > resizes with locked aspect ratio 0ms
     → localStorage.clear is not a function
   × line element > resizes from center 0ms
     → localStorage.clear is not a function
   × freedraw element > resizes 0ms
     → localStorage.clear is not a function
   × freedraw element > flips while resizing 0ms
     → localStorage.clear is not a function
   × freedraw element > resizes with locked aspect ratio 0ms
     → localStorage.clear is not a function
   × freedraw element > resizes from center 0ms
     → localStorage.clear is not a function
   × line element > resizes 0ms
     → localStorage.clear is not a function
   × line element > flips while resizing 0ms
     → localStorage.clear is not a function
   × line element > resizes with locked aspect ratio 0ms
     → localStorage.clear is not a function
   × line element > resizes from center 0ms
     → localStorage.clear is not a function
   × arrow element > resizes with a label 0ms
     → localStorage.clear is not a function
   × arrow element > flips the fixed point binding on negative resize for single bindable 0ms
     → localStorage.clear is not a function
   × arrow element > flips the fixed point binding on negative resize for group selection 0ms
     → localStorage.clear is not a function
   × text element > resizes 0ms
     → localStorage.clear is not a function
   ↓ text element > flips while resizing
   ↓ text element > resizes from center
   × text element > updates font size via keyboard 0ms
     → localStorage.clear is not a function
   × text element > can be resized from e 0ms
     → localStorage.clear is not a function
   × text element > can be resized from w 0ms
     → localStorage.clear is not a function
   × text element > wraps when width is narrower than texts inside 0ms
     → localStorage.clear is not a function
   × text element > keeps properties when wrapped 0ms
     → localStorage.clear is not a function
   × text element > has a minimum width when wrapped 0ms
     → localStorage.clear is not a function
   × image element > resizes 0ms
     → localStorage.clear is not a function
   × image element > flips while resizing 0ms
     → localStorage.clear is not a function
   × image element > resizes with locked/unlocked aspect ratio 0ms
     → localStorage.clear is not a function
   × image element > resizes from center 0ms
     → localStorage.clear is not a function
   × multiple selection > resizes with generic elements 0ms
     → localStorage.clear is not a function
   × multiple selection > resizes with linear elements > 2 points 0ms
     → localStorage.clear is not a function
   × multiple selection > resizes with 2-point lines 0ms
     → localStorage.clear is not a function
   × multiple selection > resizes with labeled arrows 0ms
     → localStorage.clear is not a function
   × multiple selection > resizes with text elements 0ms
     → localStorage.clear is not a function
   × multiple selection > resizes with images (proportional) 0ms
     → localStorage.clear is not a function
   × multiple selection > resizes from center 0ms
     → localStorage.clear is not a function
   × multiple selection > flips while resizing 0ms
     → localStorage.clear is not a function
 ✓ packages/element/tests/frame.test.tsx (33 tests | 30 skipped) 545ms
 ❯ packages/excalidraw/tests/clipboard.test.tsx (19 tests | 19 failed) 12ms
   × general paste behavior > should randomize seed on paste 5ms
     → localStorage.clear is not a function
   × general paste behavior > should retain seed on shift-paste 1ms
     → localStorage.clear is not a function
   × paste text as single lines > should create an element for each line when copying with Ctrl/Cmd+V 0ms
     → localStorage.clear is not a function
   × paste text as single lines > should ignore empty lines when creating an element for each line 0ms
     → localStorage.clear is not a function
   × paste text as single lines > should not create any element if clipboard has only new lines 0ms
     → localStorage.clear is not a function
   × paste text as single lines > should space items correctly 0ms
     → localStorage.clear is not a function
   × paste text as single lines > should leave a space for blank new lines 0ms
     → localStorage.clear is not a function
   × paste text as a single element > should create single text element when copying text with Ctrl/Cmd+Shift+V 0ms
     → localStorage.clear is not a function
   × paste text as a single element > should not create any element when only new lines in clipboard 0ms
     → localStorage.clear is not a function
   × Paste bound text container > should fix ellipse bounding box 0ms
     → localStorage.clear is not a function
   × Paste bound text container > should fix diamond bounding box 0ms
     → localStorage.clear is not a function
   × pasting & frames > should add pasted elements to frame under cursor 0ms
     → localStorage.clear is not a function
   × pasting & frames > should remove element from frame when pasted outside 0ms
     → localStorage.clear is not a function
   × pasting & frames > should filter out elements not overlapping frame 0ms
     → localStorage.clear is not a function
   × pasting & frames > should not filter out elements not overlapping frame if part of group 0ms
     → localStorage.clear is not a function
   × pasting & frames > should not filter out other frames and their children 0ms
     → localStorage.clear is not a function
   × clipboard - pasting mermaid definition > should detect and paste as mermaid 0ms
     → localStorage.clear is not a function
   × clipboard - pasting mermaid definition > should support directives 0ms
     → localStorage.clear is not a function
   × clipboard - pasting mermaid definition > should paste as normal text if invalid mermaid 0ms
     → localStorage.clear is not a function
 ❯ packages/excalidraw/tests/flip.test.tsx (46 tests | 38 failed | 8 skipped) 49ms
   × rectangle > flips an unrotated rectangle horizontally correctly 8ms
     → localStorage.clear is not a function
   × rectangle > flips an unrotated rectangle vertically correctly 1ms
     → localStorage.clear is not a function
   × rectangle > flips a rotated rectangle horizontally correctly 1ms
     → localStorage.clear is not a function
   × rectangle > flips a rotated rectangle vertically correctly 0ms
     → localStorage.clear is not a function
   × diamond > flips an unrotated diamond horizontally correctly 0ms
     → localStorage.clear is not a function
   × diamond > flips an unrotated diamond vertically correctly 0ms
     → localStorage.clear is not a function
   × diamond > flips a rotated diamond horizontally correctly 1ms
     → localStorage.clear is not a function
   × diamond > flips a rotated diamond vertically correctly 0ms
     → localStorage.clear is not a function
   × ellipse > flips an unrotated ellipse horizontally correctly 0ms
     → localStorage.clear is not a function
   × ellipse > flips an unrotated ellipse vertically correctly 0ms
     → localStorage.clear is not a function
   × ellipse > flips a rotated ellipse horizontally correctly 0ms
     → localStorage.clear is not a function
   × ellipse > flips a rotated ellipse vertically correctly 0ms
     → localStorage.clear is not a function
   × arrow > flips an unrotated arrow horizontally with line inside min/max points bounds 0ms
     → localStorage.clear is not a function
   × arrow > flips an unrotated arrow vertically with line inside min/max points bounds 0ms
     → localStorage.clear is not a function
   × arrow > flips a rotated arrow horizontally with line inside min/max points bounds 0ms
     → localStorage.clear is not a function
   × arrow > flips a rotated arrow vertically with line inside min/max points bounds 0ms
     → localStorage.clear is not a function
   ↓ arrow > flips an unrotated arrow horizontally with line outside min/max points bounds
   ↓ arrow > flips a rotated arrow horizontally with line outside min/max points bounds
   ↓ arrow > flips an unrotated arrow vertically with line outside min/max points bounds
   ↓ arrow > flips a rotated arrow vertically with line outside min/max points bounds
   × arrow > flips an unrotated arrow horizontally correctly 0ms
     → localStorage.clear is not a function
   × arrow > flips an unrotated arrow vertically correctly 0ms
     → localStorage.clear is not a function
   × arrow > flips a two points arrow horizontally correctly 0ms
     → localStorage.clear is not a function
   × arrow > flips a two points arrow vertically correctly 0ms
     → localStorage.clear is not a function
   × line > flips an unrotated line horizontally with line inside min/max points bounds 0ms
     → localStorage.clear is not a function
   × line > flips an unrotated line vertically with line inside min/max points bounds 0ms
     → localStorage.clear is not a function
   × line > flips an unrotated line horizontally correctly 0ms
     → localStorage.clear is not a function
   ↓ line > flips an unrotated line horizontally with line outside min/max points bounds
   ↓ line > flips an unrotated line vertically with line outside min/max points bounds
   ↓ line > flips a rotated line horizontally with line outside min/max points bounds
   ↓ line > flips a rotated line vertically with line outside min/max points bounds
   × line > flips an unrotated line vertically correctly 0ms
     → localStorage.clear is not a function
   × line > flips a rotated line horizontally with line inside min/max points bounds 0ms
     → localStorage.clear is not a function
   × line > flips a rotated line vertically with line inside min/max points bounds 0ms
     → localStorage.clear is not a function
   × line > flips a two points line horizontally correctly 0ms
     → localStorage.clear is not a function
   × line > flips a two points line vertically correctly 0ms
     → localStorage.clear is not a function
   × freedraw > flips an unrotated drawing horizontally correctly 25ms
     → localStorage.clear is not a function
   × freedraw > flips an unrotated drawing vertically correctly 1ms
     → localStorage.clear is not a function
   × freedraw > flips a rotated drawing horizontally correctly 0ms
     → localStorage.clear is not a function
   × freedraw > flips a rotated drawing vertically correctly 0ms
     → localStorage.clear is not a function
   × image > flips an unrotated image horizontally correctly 0ms
     → localStorage.clear is not a function
   × image > flips an unrotated image vertically correctly 0ms
     → localStorage.clear is not a function
   × image > flips an rotated image horizontally correctly 0ms
     → localStorage.clear is not a function
   × image > flips an rotated image vertically correctly 0ms
     → localStorage.clear is not a function
   × image > flips an image both vertically & horizontally 0ms
     → localStorage.clear is not a function
   × mutliple elements > with bound text flip correctly 0ms
     → localStorage.clear is not a function
 ✓ packages/excalidraw/components/Sidebar/Sidebar.test.tsx (12 tests) 1124ms
 ✓ packages/excalidraw/actions/actionDuplicateSelection.test.tsx (17 tests) 1674ms
(node:20924) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
 ✓ packages/excalidraw/tests/data/reconcile.test.ts (2 tests) 15ms
 ✓ packages/common/tests/keys.test.ts (8 tests) 5ms
(node:14784) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
 ✓ packages/excalidraw/tests/excalidraw.test.tsx (26 tests) 1948ms
 ✓ packages/element/tests/duplicate.test.tsx (20 tests) 1956ms
(node:8124) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:20536) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:20400) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:13604) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:10132) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:6288) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:7088) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:21060) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:24524) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:5228) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:19792) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
 ✓ packages/element/tests/binding.test.tsx (13 tests | 1 skipped) 2758ms
   ✓ binding for simple arrows > when both endpoints are bound inside the same element > should create an `inside` binding 526ms
 ✓ packages/utils/tests/geometry.test.ts (6 tests) 6ms
 ✓ packages/element/tests/embeddable.test.ts (7 tests) 7ms
 ❯ packages/element/tests/elbowArrow.test.tsx (8 tests | 8 failed) 10ms
   × elbow arrow segment move > can move the second segment of a fully connected elbow arrow 5ms
     → localStorage.clear is not a function
   × elbow arrow segment move > can move the second segment of an unconnected elbow arrow 1ms
     → localStorage.clear is not a function
   × elbow arrow routing > can properly generate orthogonal arrow points 1ms
     → localStorage.clear is not a function
   × elbow arrow routing > can generate proper points for bound elbow arrow 0ms
     → localStorage.clear is not a function
   × elbow arrow ui > can follow bound shapes 0ms
     → localStorage.clear is not a function
   × elbow arrow ui > can follow bound rotated shapes 0ms
     → localStorage.clear is not a function
   × elbow arrow ui > keeps arrow shape when the whole set of arrow and bindables are duplicated 0ms
     → localStorage.clear is not a function
   × elbow arrow ui > changes arrow shape to unbind variant if only the connected elbow arrow is duplicated 0ms
     → localStorage.clear is not a function
(node:15740) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
 ✓ packages/element/tests/sortElements.test.ts (4 tests | 2 skipped) 9ms
 ✓ packages/utils/tests/withinBounds.test.ts (9 tests) 9ms
 ❯ packages/excalidraw/tests/multiPointCreate.test.tsx (5 tests | 5 failed) 8ms
   × remove shape in non linear elements > rectangle 4ms
     → localStorage.clear is not a function
   × remove shape in non linear elements > ellipse 1ms
     → localStorage.clear is not a function
   × remove shape in non linear elements > diamond 0ms
     → localStorage.clear is not a function
   × multi point mode in linear elements > arrow 0ms
     → localStorage.clear is not a function
   × multi point mode in linear elements > line 0ms
     → localStorage.clear is not a function
 ❯ packages/excalidraw/tests/move.test.tsx (3 tests | 3 failed) 7ms
   × move element > rectangle 5ms
     → localStorage.clear is not a function
   × move element > rectangles with binding arrow 0ms
     → localStorage.clear is not a function
   × duplicate element on move when ALT is clicked > rectangle 0ms
     → localStorage.clear is not a function
 ✓ packages/excalidraw/clipboard.test.ts (6 tests) 33ms
 ✓ packages/math/tests/ellipse.test.ts (6 tests) 5ms
(node:19752) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
 ✓ packages/excalidraw/tests/library.test.tsx (7 tests) 890ms
(node:7768) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:17472) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
 ✓ packages/excalidraw/actions/actionFlip.test.tsx (5 tests) 783ms
   ✓ flipping re-centers selection > elbow arrow touches group selection side yet it remains in place after multiple moves 337ms
 ✓ packages/excalidraw/tests/export.test.tsx (8 tests) 806ms
 ✓ packages/utils/tests/export.test.ts (9 tests | 1 skipped) 91ms
stderr | excalidraw-app/tests/collab.test.tsx > collaboration > should emit two ephemeral increments even though updates get batched
TypeError: localStorage.getItem is not a function
    at E:\excalidraw\excalidraw-app\useHandleAppTheme.ts:15:21
    at mountStateImpl (E:\excalidraw\node_modules\react-dom\cjs\react-dom-client.development.js:6355:24)
    at mountState (E:\excalidraw\node_modules\react-dom\cjs\react-dom-client.development.js:6376:22)
    at Object.useState (E:\excalidraw\node_modules\react-dom\cjs\react-dom-client.development.js:22784:18)
    at Proxy.process.env.NODE_ENV.exports.useState (E:\excalidraw\node_modules\react\cjs\react.development.js:1500:34)
    at Module.useHandleAppTheme (E:\excalidraw\excalidraw-app\useHandleAppTheme.ts:13:35)
    at ExcalidrawWrapper (E:\excalidraw\excalidraw-app\App.tsx:345:50)
    at Object.react-stack-bottom-frame (E:\excalidraw\node_modules\react-dom\cjs\react-dom-client.development.js:22428:20)
    at renderWithHooks (E:\excalidraw\node_modules\react-dom\cjs\react-dom-client.development.js:5757:22)
    at updateFunctionComponent (E:\excalidraw\node_modules\react-dom\cjs\react-dom-client.development.js:8018:19) {
  [stack]: [Getter/Setter],
  [message]: 'localStorage.getItem is not a function'
}

The above error occurred in the <ExcalidrawWrapper> component.

React will try to recreate this component tree from scratch using the error boundary you provided, TopErrorBoundary.


stderr | excalidraw-app/tests/collab.test.tsx > collaboration > should allow to undo / redo even on force-deleted elements
TypeError: localStorage.getItem is not a function
    at E:\excalidraw\excalidraw-app\useHandleAppTheme.ts:15:21
    at mountStateImpl (E:\excalidraw\node_modules\react-dom\cjs\react-dom-client.development.js:6355:24)
    at mountState (E:\excalidraw\node_modules\react-dom\cjs\react-dom-client.development.js:6376:22)
    at Object.useState (E:\excalidraw\node_modules\react-dom\cjs\react-dom-client.development.js:22784:18)
    at Proxy.process.env.NODE_ENV.exports.useState (E:\excalidraw\node_modules\react\cjs\react.development.js:1500:34)
    at Module.useHandleAppTheme (E:\excalidraw\excalidraw-app\useHandleAppTheme.ts:13:35)
    at ExcalidrawWrapper (E:\excalidraw\excalidraw-app\App.tsx:345:50)
    at Object.react-stack-bottom-frame (E:\excalidraw\node_modules\react-dom\cjs\react-dom-client.development.js:22428:20)
    at renderWithHooks (E:\excalidraw\node_modules\react-dom\cjs\react-dom-client.development.js:5757:22)
    at updateFunctionComponent (E:\excalidraw\node_modules\react-dom\cjs\react-dom-client.development.js:8018:19) {
  [stack]: [Getter/Setter],
  [message]: 'localStorage.getItem is not a function'
}

The above error occurred in the <ExcalidrawWrapper> component.

React will try to recreate this component tree from scratch using the error boundary you provided, TopErrorBoundary.


 ❯ excalidraw-app/tests/collab.test.tsx (2 tests | 2 failed) 38ms
   × collaboration > should emit two ephemeral increments even though updates get batched 32ms
     → Missing Provider from createIsolation
   × collaboration > should allow to undo / redo even on force-deleted elements 5ms
     → Missing Provider from createIsolation
 ✓ packages/excalidraw/tests/elementLocking.test.tsx (15 tests) 1644ms
 ✓ packages/excalidraw/actions/actionProperties.test.tsx (9 tests) 1000ms
 ✓ packages/element/tests/bounds.test.ts (8 tests) 6ms
(node:3932) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:15380) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
stderr | packages/excalidraw/wysiwyg/textWysiwyg.test.tsx > textWysiwyg > Test container-bound text > should bind text to container when triggered via context menu
flushSync was called from inside a lifecycle method. React cannot flush when React is already rendering. Consider moving this call to a scheduler task or micro task.

 ✓ packages/excalidraw/actions/actionDeleteSelected.test.tsx (6 tests) 819ms
(node:7696) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
 ✓ packages/excalidraw/data/library.test.ts (1 test) 4ms
 ✓ packages/excalidraw/charts.test.ts (18 tests) 6ms
(node:23308) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:11652) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
 ✓ packages/math/tests/curve.test.ts (6 tests) 4ms
(node:21232) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
 ✓ packages/common/src/utils.test.ts (7 tests) 5ms
 ✓ packages/excalidraw/tests/fitToContent.test.tsx (5 tests) 643ms
 ✓ packages/excalidraw/tests/search.test.tsx (5 tests) 2265ms
   ✓ search > should match text and cycle through matches on Enter 581ms
   ✓ search > should match text split across multiple lines 857ms
   ✓ search > should match frame names 463ms
 ✓ packages/element/tests/fractionalIndex.test.ts (48 tests) 4629ms
   ✓ sync invalid indices with array order > should be able to sync 20K invalid indices > should sync all empty indices > should sync invalid indices of moved elements or fallback 773ms
   ✓ sync invalid indices with array order > should be able to sync 20K invalid indices > should sync all empty indices > should sync invalid indices of all elements 781ms
   ✓ sync invalid indices with array order > should be able to sync 20K invalid indices > should sync all but last index given a growing array of indices > should sync invalid indices of moved elements or fallback 805ms
   ✓ sync invalid indices with array order > should be able to sync 20K invalid indices > should sync all but last index given a growing array of indices > should sync invalid indices of all elements 730ms
   ✓ sync invalid indices with array order > should be able to sync 20K invalid indices > should sync all but first index given a declining array of indices > should sync invalid indices of moved elements or fallback 763ms
   ✓ sync invalid indices with array order > should be able to sync 20K invalid indices > should sync all but first index given a declining array of indices > should sync invalid indices of all elements 755ms
 ✓ packages/excalidraw/components/Trans.test.tsx (1 test) 34ms
 ✓ packages/excalidraw/components/DefaultSidebar.test.tsx (7 tests) 864ms
 ✓ packages/element/tests/sizeHelpers.test.ts (7 tests) 4ms
(node:20308) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
 ✓ packages/excalidraw/tests/scroll.test.tsx (2 tests) 285ms
(node:24244) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
 ✓ packages/element/tests/distribute.test.tsx (4 tests) 1170ms
   ✓ distributing > should distribute selected elements horizontally 419ms
(node:3132) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:19852) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:21644) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:1040) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:11648) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
 ✓ packages/excalidraw/components/hoc/withInternalFallback.test.tsx (4 tests) 519ms
 ✓ packages/math/tests/range.test.ts (7 tests) 4ms
stderr | packages/excalidraw/tests/MermaidToExcalidraw.test.tsx > Test <MermaidToExcalidraw/> > should open mermaid popup when active tool is mermaid
localStorage.getItem error: window.localStorage.getItem is not a function

 ✓ packages/excalidraw/tests/image.test.tsx (3 tests) 530ms
stderr | packages/excalidraw/tests/MermaidToExcalidraw.test.tsx > Test <MermaidToExcalidraw/> > should open mermaid popup when active tool is mermaid
localStorage.setItem error: window.localStorage.setItem is not a function

(node:23852) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
stderr | packages/excalidraw/tests/MermaidToExcalidraw.test.tsx > Test <MermaidToExcalidraw/> > should show error in preview when mermaid library throws error
localStorage.getItem error: window.localStorage.getItem is not a function

stderr | packages/excalidraw/tests/MermaidToExcalidraw.test.tsx > Test <MermaidToExcalidraw/> > should show error in preview when mermaid library throws error
<<< WARNING: test "Test <MermaidToExcalidraw/> > should show error in preview when mermaid library throws error" does not wrap some state update in act() >>>
localStorage.setItem error: window.localStorage.setItem is not a function

 ✓ packages/excalidraw/tests/MermaidToExcalidraw.test.tsx (2 tests) 319ms
 ✓ packages/utils/tests/utils.unmocked.test.ts (2 tests | 1 skipped) 23ms
(node:22940) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
 ✓ packages/element/tests/selection.test.ts (2 tests) 3ms
 ✓ packages/common/tests/url.test.tsx (1 test) 3ms
 ✓ packages/excalidraw/tests/actionStyles.test.tsx (1 test) 690ms
   ✓ actionStyles > should copy & paste styles via keyboard 689ms
 ✓ packages/common/tests/queue.test.ts (2 tests) 160ms
 ✓ packages/excalidraw/tests/appState.test.tsx (2 tests) 443ms
 ❯ packages/excalidraw/tests/rotate.test.tsx (2 tests | 2 failed) 6ms
   × unselected bound arrow updates when rotating its target element 4ms
     → localStorage.clear is not a function
   × unselected bound arrows update when rotating their target elements 1ms
     → localStorage.clear is not a function
 ✓ packages/excalidraw/tests/clients.test.ts (8 tests) 3ms
(node:23632) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:18124) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
 ✓ packages/excalidraw/actions/actionElementLock.test.tsx (2 tests) 373ms
(node:23696) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
 ✓ packages/math/tests/line.test.ts (3 tests) 3ms
 ✓ packages/excalidraw/tests/viewMode.test.tsx (3 tests) 449ms
(node:20312) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
(node:11048) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
 ✓ packages/excalidraw/tests/tool.test.tsx (4 tests) 551ms
 ✓ packages/element/tests/typeChecks.test.ts (3 tests) 3ms
 ✓ packages/excalidraw/tests/packages/events.test.tsx (2 tests) 268ms
 ✓ packages/excalidraw/mermaid.test.ts (1 test) 3ms
 ✓ packages/math/tests/segment.test.ts (2 tests) 2ms
 ✓ packages/math/tests/point.test.ts (1 test) 2ms
 ✓ packages/math/tests/vector.test.ts (1 test) 1ms
 ✓ packages/excalidraw/tests/scene/export.test.ts (15 tests) 8567ms
   ✓ exportToSvg > with default arguments 1058ms
   ✓ exportToSvg > with a CJK font 6962ms
(node:20684) Warning: `--localstorage-file` was provided without a valid path
(Use `node --trace-warnings ...` to show where the warning was created)
 ❯ packages/excalidraw/tests/App.test.tsx (1 test | 1 failed) 6ms
   × Test <App/> > should show error modal when using brave and measureText API is not working 5ms
     → localStorage.clear is not a function
stderr | excalidraw-app/tests/LanguageList.test.tsx
Error JSON parsing firebase config. Supplied value: undefined

 ✓ packages/excalidraw/tests/charts.test.tsx (1 test) 2ms
 ❯ packages/element/tests/collision.test.tsx (1 test | 1 failed) 4ms
   × check rotated elements can be hit: > arrow 3ms
     → localStorage.clear is not a function
stderr | excalidraw-app/tests/MobileMenu.test.tsx
Error JSON parsing firebase config. Supplied value: undefined

 ✓ packages/excalidraw/tests/shortcuts.test.tsx (1 test) 124ms
stderr | excalidraw-app/tests/LanguageList.test.tsx > Test LanguageList > rerenders UI on language change
TypeError: localStorage.getItem is not a function
    at E:\excalidraw\excalidraw-app\useHandleAppTheme.ts:15:21
    at mountStateImpl (E:\excalidraw\node_modules\react-dom\cjs\react-dom-client.development.js:6355:24)
    at mountState (E:\excalidraw\node_modules\react-dom\cjs\react-dom-client.development.js:6376:22)
    at Object.useState (E:\excalidraw\node_modules\react-dom\cjs\react-dom-client.development.js:22784:18)
    at Proxy.process.env.NODE_ENV.exports.useState (E:\excalidraw\node_modules\react\cjs\react.development.js:1500:34)
    at Module.useHandleAppTheme (E:\excalidraw\excalidraw-app\useHandleAppTheme.ts:13:35)
    at ExcalidrawWrapper (E:\excalidraw\excalidraw-app\App.tsx:345:50)
    at Object.react-stack-bottom-frame (E:\excalidraw\node_modules\react-dom\cjs\react-dom-client.development.js:22428:20)
    at renderWithHooks (E:\excalidraw\node_modules\react-dom\cjs\react-dom-client.development.js:5757:22)
    at updateFunctionComponent (E:\excalidraw\node_modules\react-dom\cjs\react-dom-client.development.js:8018:19) {
  [stack]: [Getter/Setter],
  [message]: 'localStorage.getItem is not a function'
}

The above error occurred in the <ExcalidrawWrapper> component.

React will try to recreate this component tree from scratch using the error boundary you provided, TopErrorBoundary.


 ❯ excalidraw-app/tests/LanguageList.test.tsx (1 test | 1 failed) 20ms
   × Test LanguageList > rerenders UI on language change 20ms
     → Missing Provider from createIsolation
stderr | excalidraw-app/tests/MobileMenu.test.tsx > Test MobileMenu > should set editor interface correctly
TypeError: localStorage.getItem is not a function
    at E:\excalidraw\excalidraw-app\useHandleAppTheme.ts:15:21
    at mountStateImpl (E:\excalidraw\node_modules\react-dom\cjs\react-dom-client.development.js:6355:24)
    at mountState (E:\excalidraw\node_modules\react-dom\cjs\react-dom-client.development.js:6376:22)
    at Object.useState (E:\excalidraw\node_modules\react-dom\cjs\react-dom-client.development.js:22784:18)
    at Proxy.process.env.NODE_ENV.exports.useState (E:\excalidraw\node_modules\react\cjs\react.development.js:1500:34)
    at Module.useHandleAppTheme (E:\excalidraw\excalidraw-app\useHandleAppTheme.ts:13:35)
    at ExcalidrawWrapper (E:\excalidraw\excalidraw-app\App.tsx:345:50)
    at Object.react-stack-bottom-frame (E:\excalidraw\node_modules\react-dom\cjs\react-dom-client.development.js:22428:20)
    at renderWithHooks (E:\excalidraw\node_modules\react-dom\cjs\react-dom-client.development.js:5757:22)
    at updateFunctionComponent (E:\excalidraw\node_modules\react-dom\cjs\react-dom-client.development.js:8018:19) {
  [stack]: [Getter/Setter],
  [message]: 'localStorage.getItem is not a function'
}

The above error occurred in the <ExcalidrawWrapper> component.

React will try to recreate this component tree from scratch using the error boundary you provided, TopErrorBoundary.


stderr | excalidraw-app/tests/MobileMenu.test.tsx > Test MobileMenu > should initialize with welcome screen and hide once user interacts
TypeError: localStorage.getItem is not a function
    at E:\excalidraw\excalidraw-app\useHandleAppTheme.ts:15:21
    at mountStateImpl (E:\excalidraw\node_modules\react-dom\cjs\react-dom-client.development.js:6355:24)
    at mountState (E:\excalidraw\node_modules\react-dom\cjs\react-dom-client.development.js:6376:22)
    at Object.useState (E:\excalidraw\node_modules\react-dom\cjs\react-dom-client.development.js:22784:18)
    at Proxy.process.env.NODE_ENV.exports.useState (E:\excalidraw\node_modules\react\cjs\react.development.js:1500:34)
    at Module.useHandleAppTheme (E:\excalidraw\excalidraw-app\useHandleAppTheme.ts:13:35)
    at ExcalidrawWrapper (E:\excalidraw\excalidraw-app\App.tsx:345:50)
    at Object.react-stack-bottom-frame (E:\excalidraw\node_modules\react-dom\cjs\react-dom-client.development.js:22428:20)
    at renderWithHooks (E:\excalidraw\node_modules\react-dom\cjs\react-dom-client.development.js:5757:22)
    at updateFunctionComponent (E:\excalidraw\node_modules\react-dom\cjs\react-dom-client.development.js:8018:19) {
  [stack]: [Getter/Setter],
  [message]: 'localStorage.getItem is not a function'
}

The above error occurred in the <ExcalidrawWrapper> component.

React will try to recreate this component tree from scratch using the error boundary you provided, TopErrorBoundary.


 ❯ excalidraw-app/tests/MobileMenu.test.tsx (2 tests | 2 failed) 21ms
   × Test MobileMenu > should set editor interface correctly 18ms
     → Missing Provider from createIsolation
   × Test MobileMenu > should initialize with welcome screen and hide once user interacts 2ms
     → Missing Provider from createIsolation
 ✓ packages/excalidraw/components/dropdownMenu/DropdownMenu.test.tsx (1 test) 116ms
 ✓ packages/element/tests/align.test.tsx (48 tests) 9716ms
   ✓ aligning > aligns two objects correctly to the top 382ms
   ✓ aligning > aligns a group with another element correctly to the right 312ms
   ✓ aligning > aligns two groups correctly to the bottom 323ms
   ✓ aligning > aligns two groups correctly to the right 314ms
   ✓ aligning > centers two groups correctly vertically 323ms
   ✓ aligning > aligns nested group and other element correctly to the bottom 312ms
   ✓ aligning > aligns nested group and other element correctly to the left 307ms
stderr | packages/excalidraw/wysiwyg/textWysiwyg.test.tsx > textWysiwyg > Test container-bound text > should reset the text element angle to the container's when binding to rotated non-arrow container
<<< WARNING: test "textWysiwyg > Test container-bound text > should reset the text element angle to the container's when binding to rotated non-arrow container" does not wrap some state update in act() >>>
<<< WARNING: test "textWysiwyg > Test container-bound text > should reset the text element angle to the container's when binding to rotated non-arrow container" does not wrap some state update in act() >>>
<<< WARNING: test "textWysiwyg > Test container-bound text > should reset the text element angle to the container's when binding to rotated non-arrow container" does not wrap some state update in act() >>>
<<< WARNING: test "textWysiwyg > Test container-bound text > should reset the text element angle to the container's when binding to rotated non-arrow container" does not wrap some state update in act() >>>
<<< WARNING: test "textWysiwyg > Test container-bound text > should reset the text element angle to the container's when binding to rotated non-arrow container" does not wrap some state update in act() >>>

stderr | packages/excalidraw/wysiwyg/textWysiwyg.test.tsx > textWysiwyg > Test container-bound text > should reset the text element angle to 0 when binding to rotated arrow container
<<< WARNING: test "textWysiwyg > Test container-bound text > should reset the text element angle to 0 when binding to rotated arrow container" does not wrap some state update in act() >>>
<<< WARNING: test "textWysiwyg > Test container-bound text > should reset the text element angle to 0 when binding to rotated arrow container" does not wrap some state update in act() >>>
<<< WARNING: test "textWysiwyg > Test container-bound text > should reset the text element angle to 0 when binding to rotated arrow container" does not wrap some state update in act() >>>
<<< WARNING: test "textWysiwyg > Test container-bound text > should reset the text element angle to 0 when binding to rotated arrow container" does not wrap some state update in act() >>>
<<< WARNING: test "textWysiwyg > Test container-bound text > should reset the text element angle to 0 when binding to rotated arrow container" does not wrap some state update in act() >>>

 ✓ packages/excalidraw/wysiwyg/textWysiwyg.test.tsx (61 tests | 1 skipped) 10089ms
   ✓ textWysiwyg > Test container-bound text > should wrap text and vertcially center align once text submitted 307ms
   ✓ textWysiwyg > Test container-bound text > should respect text alignment when resizing 545ms
 ✓ packages/excalidraw/tests/history.test.tsx (66 tests) 9699ms
   ✓ image insertion > should eventually initialize all dropped images 308ms
   ✓ history > singleplayer undo/redo > should not override appstate changes when redo stack is not cleared 325ms
   ✓ history > singleplayer undo/redo > should support element creation, deletion and appstate element selection change 377ms
   ✓ history > singleplayer undo/redo > should support linear element creation and points manipulation through the editor 425ms
   ✓ history > singleplayer undo/redo > should support bidirectional bindings > should unbind arrow from non deleted bindable elements on undo and rebind on redo 308ms
   ✓ history > singleplayer undo/redo > should support bidirectional bindings > should unbind everything from non deleted elements when iterating through the whole undo stack and vice versa rebind everything on redo 365ms
   ✓ history > singleplayer undo/redo > should support bidirectional bindings > should unbind rectangle from arrow on deletion and rebind on undo 334ms
   ✓ history > singleplayer undo/redo > should support bidirectional bindings > should unbind rectangles from arrow on deletion and rebind on undo 342ms

⎯⎯⎯⎯⎯⎯ Failed Suites 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  packages/excalidraw/tests/flip.test.tsx > image
TypeError: Cannot set properties of undefined (setting 'height')
 ❯ packages/excalidraw/tests/flip.test.tsx:762:13
    760|   afterAll(() => {
    761|     vi.unstubAllGlobals();
    762|     h.state.height = 0;
       |             ^
    763|   });
    764| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/392]⎯


⎯⎯⎯⎯⎯⎯ Failed Tests 323 ⎯⎯⎯⎯⎯⎯

 FAIL  excalidraw-app/tests/collab.test.tsx > collaboration > should emit two ephemeral increments even though updates get batched
 FAIL  excalidraw-app/tests/collab.test.tsx > collaboration > should allow to undo / redo even on force-deleted elements
 FAIL  excalidraw-app/tests/LanguageList.test.tsx > Test LanguageList > rerenders UI on language change
 FAIL  excalidraw-app/tests/MobileMenu.test.tsx > Test MobileMenu > should set editor interface correctly
 FAIL  excalidraw-app/tests/MobileMenu.test.tsx > Test MobileMenu > should initialize with welcome screen and hide once user interacts
Error: Missing Provider from createIsolation
 ❯ useStore node_modules/jotai-scope/src/createIsolation.tsx:47:19
 ❯ Module.useAtomValue$1 node_modules/jotai-scope/src/createIsolation.tsx:57:19
 ❯ Module.useI18n packages/excalidraw/i18n.ts:170:20
    168| //   is memoized w/o being updated on `langCode`, `AppState`, or `UIAp…
    169| export const useI18n = () => {
    170|   const langCode = useAtomValue(editorLangCodeAtom);
       |                    ^
    171|   return { t, langCode };
    172| };
 ❯ Trans packages/excalidraw/components/Trans.tsx:161:17
 ❯ Object.react-stack-bottom-frame node_modules/react-dom/cjs/react-dom-client.development.js:22428:20
 ❯ renderWithHooks node_modules/react-dom/cjs/react-dom-client.development.js:5757:22
 ❯ updateFunctionComponent node_modules/react-dom/cjs/react-dom-client.development.js:8018:19
 ❯ beginWork node_modules/react-dom/cjs/react-dom-client.development.js:9683:18
 ❯ runWithFiberInDEV node_modules/react-dom/cjs/react-dom-client.development.js:543:16
 ❯ performUnitOfWork node_modules/react-dom/cjs/react-dom-client.development.js:15052:22

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/392]⎯

 FAIL  packages/element/tests/collision.test.tsx > check rotated elements can be hit: > arrow
TypeError: localStorage.clear is not a function
 ❯ packages/element/tests/collision.test.tsx:11:18
      9| describe("check rotated elements can be hit:", () => {
     10|   beforeEach(async () => {
     11|     localStorage.clear();
       |                  ^
     12|     await render(<Excalidraw handleKeyboardGlobally={true} />);
     13|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/392]⎯

 FAIL  packages/element/tests/cropElement.test.tsx > Enter and leave the crop editor > enter the editor by double clicking
 FAIL  packages/element/tests/cropElement.test.tsx > Enter and leave the crop editor > enter the editor by pressing enter
 FAIL  packages/element/tests/cropElement.test.tsx > Enter and leave the crop editor > leave the editor by clicking outside
 FAIL  packages/element/tests/cropElement.test.tsx > Enter and leave the crop editor > leave the editor by pressing escape
 FAIL  packages/element/tests/cropElement.test.tsx > Crop an image > Cropping changes the dimension
 FAIL  packages/element/tests/cropElement.test.tsx > Crop an image > Cropping has minimal sizes
 FAIL  packages/element/tests/cropElement.test.tsx > Crop an image > Preserve aspect ratio
 FAIL  packages/element/tests/cropElement.test.tsx > Cropping and other features > Cropping works independently of duplication
 FAIL  packages/element/tests/cropElement.test.tsx > Cropping and other features > Resizing should not affect crop
 FAIL  packages/element/tests/cropElement.test.tsx > Cropping and other features > Flipping does not change crop
 FAIL  packages/element/tests/cropElement.test.tsx > Cropping and other features > Exports should preserve crops
TypeError: localStorage.clear is not a function
 ❯ packages/element/tests/cropElement.test.tsx:38:16
     36| 
     37|   mouse.reset();
     38|   localStorage.clear();
       |                ^
     39|   sessionStorage.clear();
     40|   vi.clearAllMocks();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/392]⎯

 FAIL  packages/element/tests/elbowArrow.test.tsx > elbow arrow segment move > can move the second segment of a fully connected elbow arrow
 FAIL  packages/element/tests/elbowArrow.test.tsx > elbow arrow segment move > can move the second segment of an unconnected elbow arrow
TypeError: localStorage.clear is not a function
 ❯ packages/element/tests/elbowArrow.test.tsx:34:18
     32| describe("elbow arrow segment move", () => {
     33|   beforeEach(async () => {
     34|     localStorage.clear();
       |                  ^
     35|     await render(<Excalidraw handleKeyboardGlobally={true} />);
     36|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/392]⎯

 FAIL  packages/element/tests/elbowArrow.test.tsx > elbow arrow routing > can properly generate orthogonal arrow points
 FAIL  packages/element/tests/elbowArrow.test.tsx > elbow arrow routing > can generate proper points for bound elbow arrow
TypeError: localStorage.clear is not a function
 ❯ packages/element/tests/elbowArrow.test.tsx:135:18
    133| describe("elbow arrow routing", () => {
    134|   beforeEach(async () => {
    135|     localStorage.clear();
       |                  ^
    136|     await render(<Excalidraw handleKeyboardGlobally={true} />);
    137|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/392]⎯

 FAIL  packages/element/tests/elbowArrow.test.tsx > elbow arrow ui > can follow bound shapes
 FAIL  packages/element/tests/elbowArrow.test.tsx > elbow arrow ui > can follow bound rotated shapes
 FAIL  packages/element/tests/elbowArrow.test.tsx > elbow arrow ui > keeps arrow shape when the whole set of arrow and bindables are duplicated
 FAIL  packages/element/tests/elbowArrow.test.tsx > elbow arrow ui > changes arrow shape to unbind variant if only the connected elbow arrow is duplicated
TypeError: localStorage.clear is not a function
 ❯ packages/element/tests/elbowArrow.test.tsx:211:18
    209| describe("elbow arrow ui", () => {
    210|   beforeEach(async () => {
    211|     localStorage.clear();
       |                  ^
    212|     await render(<Excalidraw handleKeyboardGlobally={true} />);
    213| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/392]⎯

 FAIL  packages/element/tests/flowchart.test.tsx > flow chart creation > create multiple successor nodes at once
 FAIL  packages/element/tests/flowchart.test.tsx > flow chart creation > when directions are changed, only the last same directions will apply
 FAIL  packages/element/tests/flowchart.test.tsx > flow chart creation > when escaped, no nodes will be created
 FAIL  packages/element/tests/flowchart.test.tsx > flow chart creation > create nodes one at a time
 FAIL  packages/element/tests/flowchart.test.tsx > flow chart navigation > single node at each level
 FAIL  packages/element/tests/flowchart.test.tsx > flow chart navigation > multiple nodes at each level
 FAIL  packages/element/tests/flowchart.test.tsx > flow chart navigation > take the most obvious link when possible
TypeError: localStorage.clear is not a function
 ❯ packages/element/tests/flowchart.test.tsx:18:16
     16| 
     17| beforeEach(async () => {
     18|   localStorage.clear();
       |                ^
     19|   reseed(7);
     20|   mouse.reset();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/392]⎯

 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > should normalize the element points at creation
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > should not drag line and add midpoint until dragged beyond a threshold
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > should allow dragging line from midpoint in 2 pointer lines outside editor
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > should allow entering and exiting line editor via context menu
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > should enter line editor via enter (line)
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > should enter line editor via ctrl+enter (line)
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > should enter line editor via ctrl+enter (arrow)
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > should enter line editor on ctrl+dblclick (simple arrow)
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > should enter line editor on ctrl+dblclick (line)
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > should enter line editor on dblclick (line)
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > should not enter line editor on dblclick (arrow)
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > shouldn't create text element on double click in line editor (arrow)
TypeError: localStorage.clear is not a function
 ❯ packages/element/tests/linearElementEditor.test.tsx:62:18
     60|   beforeEach(async () => {
     61|     unmountComponent();
     62|     localStorage.clear();
       |                  ^
     63|     renderInteractiveScene.mockClear();
     64|     renderStaticScene.mockClear();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/392]⎯

 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > Inside editor > should not drag line and add midpoint when dragged irrespective of threshold
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > Inside editor > should allow dragging line from midpoint in 2 pointer lines
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > Inside editor > should update the midpoints when element roundness changed
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > Inside editor > should update all the midpoints when element position changed
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > Inside editor > When edges are round > should allow dragging lines from midpoints in between segments
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > Inside editor > When edges are round > should update only the first segment midpoint when its point is dragged
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > Inside editor > When edges are round > should hide midpoints in the segment when points moved close
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > Inside editor > When edges are round > should remove the midpoint when one of the points in the segment is deleted
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > Inside editor > When edges are round > should allow dragging lines from midpoints in between segments
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > Inside editor > When edges are round > should update all the midpoints when its point is dragged
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > Inside editor > When edges are round > should hide midpoints in the segment when points moved close
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > Inside editor > When edges are round > should update all the midpoints when a point is deleted
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > Inside editor > in-editor dragging a line point covered by another element
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > Test bound text element > Test getBoundTextElementPosition > should return correct position for 2 pointer arrow
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > Test bound text element > Test getBoundTextElementPosition > should return correct position for arrow with odd points
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > Test bound text element > Test getBoundTextElementPosition > should return correct position for arrow with even points
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > Test bound text element > should match styles for text editor
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > Test bound text element > should bind text to arrow when double clicked
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > Test bound text element > should bind text to arrow when clicked on arrow and enter pressed
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > Test bound text element > should not bind text to line when double clicked
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > Test bound text element > should resize and position the bound text and bounding box correctly when 3 pointer arrow element resized
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > Test bound text element > should resize and position the bound text correctly when 2 pointer linear element resized
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > Test bound text element > should not render vertical align tool when element selected
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > Test bound text element > should wrap the bound text when arrow bound container moves
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > Test bound text element > should not render horizontal align tool when element selected
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > Test bound text element > should update label coords when a label binded via context menu is unbinded
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > Test bound text element > should not update label position when arrow dragged
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > Test moving linear element points > should move the endpoint in the negative direction correctly when the start point is also moved in the positive direction
 FAIL  packages/element/tests/linearElementEditor.test.tsx > Test Linear Elements > Test moving linear element points > should preserve original angle when dragging endpoint with SHIFT key
TypeError: localStorage.clear is not a function
 ❯ packages/element/tests/linearElementEditor.test.tsx:62:18
     60|   beforeEach(async () => {
     61|     unmountComponent();
     62|     localStorage.clear();
       |                  ^
     63|     renderInteractiveScene.mockClear();
     64|     renderStaticScene.mockClear();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/392]⎯

 FAIL  packages/element/tests/resize.test.tsx > generic element > resizes > with handle 'n'
 FAIL  packages/element/tests/resize.test.tsx > generic element > resizes > with handle 'e'
 FAIL  packages/element/tests/resize.test.tsx > generic element > resizes > with handle 's'
 FAIL  packages/element/tests/resize.test.tsx > generic element > resizes > with handle 'w'
 FAIL  packages/element/tests/resize.test.tsx > generic element > resizes > with handle 'ne'
 FAIL  packages/element/tests/resize.test.tsx > generic element > resizes > with handle 'se'
 FAIL  packages/element/tests/resize.test.tsx > generic element > resizes > with handle 'sw'
 FAIL  packages/element/tests/resize.test.tsx > generic element > resizes > with handle 'nw'
 FAIL  packages/element/tests/resize.test.tsx > generic element > flips while resizing > with handle 'n'
 FAIL  packages/element/tests/resize.test.tsx > generic element > flips while resizing > with handle 'e'
 FAIL  packages/element/tests/resize.test.tsx > generic element > flips while resizing > with handle 's'
 FAIL  packages/element/tests/resize.test.tsx > generic element > flips while resizing > with handle 'w'
 FAIL  packages/element/tests/resize.test.tsx > generic element > flips while resizing > with handle 'ne'
 FAIL  packages/element/tests/resize.test.tsx > generic element > flips while resizing > with handle 'se'
 FAIL  packages/element/tests/resize.test.tsx > generic element > flips while resizing > with handle 'sw'
 FAIL  packages/element/tests/resize.test.tsx > generic element > flips while resizing > with handle 'nw'
TypeError: localStorage.clear is not a function
 ❯ packages/element/tests/resize.test.tsx:57:16
     55| 
     56| beforeEach(async () => {
     57|   localStorage.clear();
       |                ^
     58|   reseed(7);
     59|   mouse.reset();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/392]⎯

 FAIL  packages/element/tests/resize.test.tsx > generic element > resizes with locked aspect ratio
 FAIL  packages/element/tests/resize.test.tsx > generic element > resizes from center
 FAIL  packages/element/tests/resize.test.tsx > generic element > resizes with a label
 FAIL  packages/element/tests/resize.test.tsx > line element > resizes
 FAIL  packages/element/tests/resize.test.tsx > line element > flips while resizing
 FAIL  packages/element/tests/resize.test.tsx > line element > resizes with locked aspect ratio
 FAIL  packages/element/tests/resize.test.tsx > line element > resizes from center
 FAIL  packages/element/tests/resize.test.tsx > freedraw element > resizes
 FAIL  packages/element/tests/resize.test.tsx > freedraw element > flips while resizing
 FAIL  packages/element/tests/resize.test.tsx > freedraw element > resizes with locked aspect ratio
 FAIL  packages/element/tests/resize.test.tsx > freedraw element > resizes from center
 FAIL  packages/element/tests/resize.test.tsx > line element > resizes
 FAIL  packages/element/tests/resize.test.tsx > line element > flips while resizing
 FAIL  packages/element/tests/resize.test.tsx > line element > resizes with locked aspect ratio
 FAIL  packages/element/tests/resize.test.tsx > line element > resizes from center
 FAIL  packages/element/tests/resize.test.tsx > arrow element > resizes with a label
 FAIL  packages/element/tests/resize.test.tsx > arrow element > flips the fixed point binding on negative resize for single bindable
 FAIL  packages/element/tests/resize.test.tsx > arrow element > flips the fixed point binding on negative resize for group selection
 FAIL  packages/element/tests/resize.test.tsx > text element > resizes
 FAIL  packages/element/tests/resize.test.tsx > text element > updates font size via keyboard
 FAIL  packages/element/tests/resize.test.tsx > text element > can be resized from e
 FAIL  packages/element/tests/resize.test.tsx > text element > can be resized from w
 FAIL  packages/element/tests/resize.test.tsx > text element > wraps when width is narrower than texts inside
 FAIL  packages/element/tests/resize.test.tsx > text element > keeps properties when wrapped
 FAIL  packages/element/tests/resize.test.tsx > text element > has a minimum width when wrapped
 FAIL  packages/element/tests/resize.test.tsx > image element > resizes
 FAIL  packages/element/tests/resize.test.tsx > image element > flips while resizing
 FAIL  packages/element/tests/resize.test.tsx > image element > resizes with locked/unlocked aspect ratio
 FAIL  packages/element/tests/resize.test.tsx > image element > resizes from center
 FAIL  packages/element/tests/resize.test.tsx > multiple selection > resizes with generic elements
 FAIL  packages/element/tests/resize.test.tsx > multiple selection > resizes with linear elements > 2 points
 FAIL  packages/element/tests/resize.test.tsx > multiple selection > resizes with 2-point lines
 FAIL  packages/element/tests/resize.test.tsx > multiple selection > resizes with labeled arrows
 FAIL  packages/element/tests/resize.test.tsx > multiple selection > resizes with text elements
 FAIL  packages/element/tests/resize.test.tsx > multiple selection > resizes with images (proportional)
 FAIL  packages/element/tests/resize.test.tsx > multiple selection > resizes from center
 FAIL  packages/element/tests/resize.test.tsx > multiple selection > flips while resizing
TypeError: localStorage.clear is not a function
 ❯ packages/element/tests/resize.test.tsx:57:16
     55| 
     56| beforeEach(async () => {
     57|   localStorage.clear();
       |                ^
     58|   reseed(7);
     59|   mouse.reset();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/392]⎯

 FAIL  packages/element/tests/zindex.test.tsx > z-index manipulation > send back
 FAIL  packages/element/tests/zindex.test.tsx > z-index manipulation > bring forward
 FAIL  packages/element/tests/zindex.test.tsx > z-index manipulation > bring to front
 FAIL  packages/element/tests/zindex.test.tsx > z-index manipulation > send to back
 FAIL  packages/element/tests/zindex.test.tsx > z-index manipulation > duplicating elements should retain zindex integrity
 FAIL  packages/element/tests/zindex.test.tsx > z-index manipulation > duplicating incorrectly interleaved elements (group elements should be together) should still produce reasonable result
 FAIL  packages/element/tests/zindex.test.tsx > z-index manipulation > group-selected duplication should includes deleted elements that weren't selected on account of being deleted
 FAIL  packages/element/tests/zindex.test.tsx > z-index manipulation > text-container binding should be atomic
 FAIL  packages/element/tests/zindex.test.tsx > z-indexing with frames > moving whole frame by one (normalized)
 FAIL  packages/element/tests/zindex.test.tsx > z-indexing with frames > moving whole frame by one (DENORMALIZED)
 FAIL  packages/element/tests/zindex.test.tsx > z-indexing with frames > moving selected frame children by one (normalized)
 FAIL  packages/element/tests/zindex.test.tsx > z-indexing with frames > moving selected frame children by one (DENORMALIZED)
 FAIL  packages/element/tests/zindex.test.tsx > z-indexing with frames > moving whole frame to front/end
TypeError: localStorage.clear is not a function
 ❯ packages/element/tests/zindex.test.tsx:34:16
     32| 
     33| beforeEach(() => {
     34|   localStorage.clear();
       |                ^
     35|   reseed(7);
     36| });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/392]⎯

 FAIL  packages/excalidraw/tests/App.test.tsx > Test <App/> > should show error modal when using brave and measureText API is not working
TypeError: localStorage.clear is not a function
 ❯ packages/excalidraw/tests/App.test.tsx:15:18
     13|   beforeEach(async () => {
     14|     unmountComponent();
     15|     localStorage.clear();
       |                  ^
     16|     renderStaticScene.mockClear();
     17|     reseed(7);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/392]⎯

 FAIL  packages/excalidraw/tests/clipboard.test.tsx > general paste behavior > should randomize seed on paste
 FAIL  packages/excalidraw/tests/clipboard.test.tsx > general paste behavior > should retain seed on shift-paste
 FAIL  packages/excalidraw/tests/clipboard.test.tsx > paste text as single lines > should create an element for each line when copying with Ctrl/Cmd+V
 FAIL  packages/excalidraw/tests/clipboard.test.tsx > paste text as single lines > should ignore empty lines when creating an element for each line
 FAIL  packages/excalidraw/tests/clipboard.test.tsx > paste text as single lines > should not create any element if clipboard has only new lines
 FAIL  packages/excalidraw/tests/clipboard.test.tsx > paste text as single lines > should space items correctly
 FAIL  packages/excalidraw/tests/clipboard.test.tsx > paste text as single lines > should leave a space for blank new lines
 FAIL  packages/excalidraw/tests/clipboard.test.tsx > paste text as a single element > should create single text element when copying text with Ctrl/Cmd+Shift+V
 FAIL  packages/excalidraw/tests/clipboard.test.tsx > paste text as a single element > should not create any element when only new lines in clipboard
 FAIL  packages/excalidraw/tests/clipboard.test.tsx > Paste bound text container > should fix ellipse bounding box
 FAIL  packages/excalidraw/tests/clipboard.test.tsx > Paste bound text container > should fix diamond bounding box
 FAIL  packages/excalidraw/tests/clipboard.test.tsx > pasting & frames > should add pasted elements to frame under cursor
 FAIL  packages/excalidraw/tests/clipboard.test.tsx > pasting & frames > should remove element from frame when pasted outside
 FAIL  packages/excalidraw/tests/clipboard.test.tsx > pasting & frames > should filter out elements not overlapping frame
 FAIL  packages/excalidraw/tests/clipboard.test.tsx > pasting & frames > should not filter out elements not overlapping frame if part of group
 FAIL  packages/excalidraw/tests/clipboard.test.tsx > pasting & frames > should not filter out other frames and their children
 FAIL  packages/excalidraw/tests/clipboard.test.tsx > clipboard - pasting mermaid definition > should detect and paste as mermaid
 FAIL  packages/excalidraw/tests/clipboard.test.tsx > clipboard - pasting mermaid definition > should support directives
 FAIL  packages/excalidraw/tests/clipboard.test.tsx > clipboard - pasting mermaid definition > should paste as normal text if invalid mermaid
TypeError: localStorage.clear is not a function
 ❯ packages/excalidraw/tests/clipboard.test.tsx:77:16
     75|   unmountComponent();
     76| 
     77|   localStorage.clear();
       |                ^
     78| 
     79|   mouse.reset();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/392]⎯

 FAIL  packages/excalidraw/tests/contextmenu.test.tsx > contextMenu element > shows context menu for canvas
 FAIL  packages/excalidraw/tests/contextmenu.test.tsx > contextMenu element > shows context menu for element
 FAIL  packages/excalidraw/tests/contextmenu.test.tsx > contextMenu element > shows context menu for element
 FAIL  packages/excalidraw/tests/contextmenu.test.tsx > contextMenu element > shows 'Group selection' in context menu for multiple selected elements
 FAIL  packages/excalidraw/tests/contextmenu.test.tsx > contextMenu element > shows 'Ungroup selection' in context menu for group inside selected elements
 FAIL  packages/excalidraw/tests/contextmenu.test.tsx > contextMenu element > selecting 'Copy styles' in context menu copies styles
 FAIL  packages/excalidraw/tests/contextmenu.test.tsx > contextMenu element > selecting 'Paste styles' in context menu pastes styles
 FAIL  packages/excalidraw/tests/contextmenu.test.tsx > contextMenu element > selecting 'Delete' in context menu deletes element
 FAIL  packages/excalidraw/tests/contextmenu.test.tsx > contextMenu element > selecting 'Add to library' in context menu adds element to library
 FAIL  packages/excalidraw/tests/contextmenu.test.tsx > contextMenu element > selecting 'Duplicate' in context menu duplicates element
 FAIL  packages/excalidraw/tests/contextmenu.test.tsx > contextMenu element > selecting 'Send backward' in context menu sends element backward
 FAIL  packages/excalidraw/tests/contextmenu.test.tsx > contextMenu element > selecting 'Bring forward' in context menu brings element forward
 FAIL  packages/excalidraw/tests/contextmenu.test.tsx > contextMenu element > selecting 'Send to back' in context menu sends element to back
 FAIL  packages/excalidraw/tests/contextmenu.test.tsx > contextMenu element > selecting 'Bring to front' in context menu brings element to front
 FAIL  packages/excalidraw/tests/contextmenu.test.tsx > contextMenu element > selecting 'Group selection' in context menu groups selected elements
 FAIL  packages/excalidraw/tests/contextmenu.test.tsx > contextMenu element > selecting 'Ungroup selection' in context menu ungroups selected group
 FAIL  packages/excalidraw/tests/contextmenu.test.tsx > contextMenu element > right-clicking on a group should select whole group
TypeError: localStorage.clear is not a function
 ❯ packages/excalidraw/tests/contextmenu.test.tsx:51:16
     49| const renderStaticScene = vi.spyOn(StaticScene, "renderStaticScene");
     50| beforeEach(() => {
     51|   localStorage.clear();
       |                ^
     52|   renderStaticScene.mockClear();
     53|   reseed(7);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/392]⎯

 FAIL  packages/excalidraw/tests/contextmenu.test.tsx > contextMenu element > shows context menu for canvas
 FAIL  packages/excalidraw/tests/contextmenu.test.tsx > contextMenu element > shows context menu for element
 FAIL  packages/excalidraw/tests/contextmenu.test.tsx > contextMenu element > shows context menu for element
 FAIL  packages/excalidraw/tests/contextmenu.test.tsx > contextMenu element > shows 'Group selection' in context menu for multiple selected elements
 FAIL  packages/excalidraw/tests/contextmenu.test.tsx > contextMenu element > shows 'Ungroup selection' in context menu for group inside selected elements
 FAIL  packages/excalidraw/tests/contextmenu.test.tsx > contextMenu element > selecting 'Copy styles' in context menu copies styles
 FAIL  packages/excalidraw/tests/contextmenu.test.tsx > contextMenu element > selecting 'Paste styles' in context menu pastes styles
 FAIL  packages/excalidraw/tests/contextmenu.test.tsx > contextMenu element > selecting 'Delete' in context menu deletes element
 FAIL  packages/excalidraw/tests/contextmenu.test.tsx > contextMenu element > selecting 'Add to library' in context menu adds element to library
 FAIL  packages/excalidraw/tests/contextmenu.test.tsx > contextMenu element > selecting 'Duplicate' in context menu duplicates element
 FAIL  packages/excalidraw/tests/contextmenu.test.tsx > contextMenu element > selecting 'Send backward' in context menu sends element backward
 FAIL  packages/excalidraw/tests/contextmenu.test.tsx > contextMenu element > selecting 'Bring forward' in context menu brings element forward
 FAIL  packages/excalidraw/tests/contextmenu.test.tsx > contextMenu element > selecting 'Send to back' in context menu sends element to back
 FAIL  packages/excalidraw/tests/contextmenu.test.tsx > contextMenu element > selecting 'Bring to front' in context menu brings element to front
 FAIL  packages/excalidraw/tests/contextmenu.test.tsx > contextMenu element > selecting 'Group selection' in context menu groups selected elements
 FAIL  packages/excalidraw/tests/contextmenu.test.tsx > contextMenu element > selecting 'Ungroup selection' in context menu ungroups selected group
 FAIL  packages/excalidraw/tests/contextmenu.test.tsx > contextMenu element > right-clicking on a group should select whole group
TypeError: Cannot read properties of undefined (reading 'length')
 ❯ checkpoint packages/excalidraw/tests/contextmenu.test.tsx:37:21
     35|   );
     36|   expect(h.state).toMatchSnapshot(`[${name}] appState`);
     37|   expect(h.elements.length).toMatchSnapshot(`[${name}] number of eleme…
       |                     ^
     38|   h.elements.forEach((element, i) =>
     39|     expect(element).toMatchSnapshot(`[${name}] element ${i}`),
 ❯ packages/excalidraw/tests/contextmenu.test.tsx:77:5

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/392]⎯

 FAIL  packages/excalidraw/tests/dragCreate.test.tsx > Test dragCreate > add element to the scene when pointer dragging long enough > rectangle
 FAIL  packages/excalidraw/tests/dragCreate.test.tsx > Test dragCreate > add element to the scene when pointer dragging long enough > ellipse
 FAIL  packages/excalidraw/tests/dragCreate.test.tsx > Test dragCreate > add element to the scene when pointer dragging long enough > diamond
 FAIL  packages/excalidraw/tests/dragCreate.test.tsx > Test dragCreate > add element to the scene when pointer dragging long enough > arrow
 FAIL  packages/excalidraw/tests/dragCreate.test.tsx > Test dragCreate > add element to the scene when pointer dragging long enough > line
 FAIL  packages/excalidraw/tests/dragCreate.test.tsx > Test dragCreate > do not add element to the scene if size is too small > rectangle
 FAIL  packages/excalidraw/tests/dragCreate.test.tsx > Test dragCreate > do not add element to the scene if size is too small > ellipse
 FAIL  packages/excalidraw/tests/dragCreate.test.tsx > Test dragCreate > do not add element to the scene if size is too small > diamond
 FAIL  packages/excalidraw/tests/dragCreate.test.tsx > Test dragCreate > do not add element to the scene if size is too small > arrow
 FAIL  packages/excalidraw/tests/dragCreate.test.tsx > Test dragCreate > do not add element to the scene if size is too small > line
TypeError: localStorage.clear is not a function
 ❯ packages/excalidraw/tests/dragCreate.test.tsx:29:16
     27| 
     28| beforeEach(() => {
     29|   localStorage.clear();
       |                ^
     30|   renderInteractiveScene.mockClear();
     31|   renderStaticScene.mockClear();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/392]⎯

 FAIL  packages/excalidraw/tests/flip.test.tsx > rectangle > flips an unrotated rectangle horizontally correctly
 FAIL  packages/excalidraw/tests/flip.test.tsx > rectangle > flips an unrotated rectangle vertically correctly
 FAIL  packages/excalidraw/tests/flip.test.tsx > rectangle > flips a rotated rectangle horizontally correctly
 FAIL  packages/excalidraw/tests/flip.test.tsx > rectangle > flips a rotated rectangle vertically correctly
 FAIL  packages/excalidraw/tests/flip.test.tsx > diamond > flips an unrotated diamond horizontally correctly
 FAIL  packages/excalidraw/tests/flip.test.tsx > diamond > flips an unrotated diamond vertically correctly
 FAIL  packages/excalidraw/tests/flip.test.tsx > diamond > flips a rotated diamond horizontally correctly
 FAIL  packages/excalidraw/tests/flip.test.tsx > diamond > flips a rotated diamond vertically correctly
 FAIL  packages/excalidraw/tests/flip.test.tsx > ellipse > flips an unrotated ellipse horizontally correctly
 FAIL  packages/excalidraw/tests/flip.test.tsx > ellipse > flips an unrotated ellipse vertically correctly
 FAIL  packages/excalidraw/tests/flip.test.tsx > ellipse > flips a rotated ellipse horizontally correctly
 FAIL  packages/excalidraw/tests/flip.test.tsx > ellipse > flips a rotated ellipse vertically correctly
 FAIL  packages/excalidraw/tests/flip.test.tsx > arrow > flips an unrotated arrow horizontally with line inside min/max points bounds
 FAIL  packages/excalidraw/tests/flip.test.tsx > arrow > flips an unrotated arrow vertically with line inside min/max points bounds
 FAIL  packages/excalidraw/tests/flip.test.tsx > arrow > flips a rotated arrow horizontally with line inside min/max points bounds
 FAIL  packages/excalidraw/tests/flip.test.tsx > arrow > flips a rotated arrow vertically with line inside min/max points bounds
 FAIL  packages/excalidraw/tests/flip.test.tsx > arrow > flips an unrotated arrow horizontally correctly
 FAIL  packages/excalidraw/tests/flip.test.tsx > arrow > flips an unrotated arrow vertically correctly
 FAIL  packages/excalidraw/tests/flip.test.tsx > arrow > flips a two points arrow horizontally correctly
 FAIL  packages/excalidraw/tests/flip.test.tsx > arrow > flips a two points arrow vertically correctly
 FAIL  packages/excalidraw/tests/flip.test.tsx > line > flips an unrotated line horizontally with line inside min/max points bounds
 FAIL  packages/excalidraw/tests/flip.test.tsx > line > flips an unrotated line vertically with line inside min/max points bounds
 FAIL  packages/excalidraw/tests/flip.test.tsx > line > flips an unrotated line horizontally correctly
 FAIL  packages/excalidraw/tests/flip.test.tsx > line > flips an unrotated line vertically correctly
 FAIL  packages/excalidraw/tests/flip.test.tsx > line > flips a rotated line horizontally with line inside min/max points bounds
 FAIL  packages/excalidraw/tests/flip.test.tsx > line > flips a rotated line vertically with line inside min/max points bounds
 FAIL  packages/excalidraw/tests/flip.test.tsx > line > flips a two points line horizontally correctly
 FAIL  packages/excalidraw/tests/flip.test.tsx > line > flips a two points line vertically correctly
 FAIL  packages/excalidraw/tests/flip.test.tsx > freedraw > flips an unrotated drawing horizontally correctly
 FAIL  packages/excalidraw/tests/flip.test.tsx > freedraw > flips an unrotated drawing vertically correctly
 FAIL  packages/excalidraw/tests/flip.test.tsx > freedraw > flips a rotated drawing horizontally correctly
 FAIL  packages/excalidraw/tests/flip.test.tsx > freedraw > flips a rotated drawing vertically correctly
 FAIL  packages/excalidraw/tests/flip.test.tsx > image > flips an unrotated image horizontally correctly
 FAIL  packages/excalidraw/tests/flip.test.tsx > image > flips an unrotated image vertically correctly
 FAIL  packages/excalidraw/tests/flip.test.tsx > image > flips an rotated image horizontally correctly
 FAIL  packages/excalidraw/tests/flip.test.tsx > image > flips an rotated image vertically correctly
 FAIL  packages/excalidraw/tests/flip.test.tsx > image > flips an image both vertically & horizontally
 FAIL  packages/excalidraw/tests/flip.test.tsx > mutliple elements > with bound text flip correctly
TypeError: localStorage.clear is not a function
 ❯ packages/excalidraw/tests/flip.test.tsx:61:16
     59| 
     60|   mouse.reset();
     61|   localStorage.clear();
       |                ^
     62|   sessionStorage.clear();
     63|   vi.clearAllMocks();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/392]⎯

 FAIL  packages/excalidraw/tests/lasso.test.tsx > Basic lasso selection tests > None should be selected
 FAIL  packages/excalidraw/tests/lasso.test.tsx > Basic lasso selection tests > Intersects some, does not enclose/intersect the rest
 FAIL  packages/excalidraw/tests/lasso.test.tsx > Basic lasso selection tests > Intersects some and encloses some
 FAIL  packages/excalidraw/tests/lasso.test.tsx > Basic lasso selection tests > Single linear element
 FAIL  packages/excalidraw/tests/lasso.test.tsx > Special cases > Select only frame if its children are also selected
 FAIL  packages/excalidraw/tests/lasso.test.tsx > Special cases > Selects group if any group from group is selected
TypeError: localStorage.clear is not a function
 ❯ packages/excalidraw/tests/lasso.test.tsx:40:16
     38| 
     39| beforeEach(async () => {
     40|   localStorage.clear();
       |                ^
     41|   await render(<Excalidraw handleKeyboardGlobally={true} />);
     42|   h.state.width = 1000;

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/392]⎯

 FAIL  packages/excalidraw/tests/move.test.tsx > move element > rectangle
 FAIL  packages/excalidraw/tests/move.test.tsx > move element > rectangles with binding arrow
 FAIL  packages/excalidraw/tests/move.test.tsx > duplicate element on move when ALT is clicked > rectangle
TypeError: localStorage.clear is not a function
 ❯ packages/excalidraw/tests/move.test.tsx:28:16
     26| 
     27| beforeEach(() => {
     28|   localStorage.clear();
       |                ^
     29|   renderInteractiveScene.mockClear();
     30|   renderStaticScene.mockClear();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/392]⎯

 FAIL  packages/excalidraw/tests/multiPointCreate.test.tsx > remove shape in non linear elements > rectangle
 FAIL  packages/excalidraw/tests/multiPointCreate.test.tsx > remove shape in non linear elements > ellipse
 FAIL  packages/excalidraw/tests/multiPointCreate.test.tsx > remove shape in non linear elements > diamond
 FAIL  packages/excalidraw/tests/multiPointCreate.test.tsx > multi point mode in linear elements > arrow
 FAIL  packages/excalidraw/tests/multiPointCreate.test.tsx > multi point mode in linear elements > line
TypeError: localStorage.clear is not a function
 ❯ packages/excalidraw/tests/multiPointCreate.test.tsx:30:16
     28| 
     29| beforeEach(() => {
     30|   localStorage.clear();
       |                ^
     31|   renderInteractiveScene.mockClear();
     32|   renderStaticScene.mockClear();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/392]⎯

 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > draw every type of shape
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > click to select a shape
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > key 2 selects rectangle tool
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > key r selects rectangle tool
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > key 3 selects diamond tool
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > key d selects diamond tool
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > key 4 selects ellipse tool
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > key o selects ellipse tool
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > key 5 selects arrow tool
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > key a selects arrow tool
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > key 6 selects line tool
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > key l selects line tool
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > key 7 selects freedraw tool
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > key p selects freedraw tool
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > change the properties of a shape
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > click on an element and drag it
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > alt-drag duplicates an element
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > click-drag to select a group
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > shift-click to multiselect, then drag
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > pinch-to-zoom works
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > two-finger scroll works
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > spacebar + drag scrolls the canvas
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > arrow keys
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > undo/redo drawing an element
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > noop interaction after undo shouldn't create history entry
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > zoom hotkeys
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > make a group and duplicate it
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > should group elements and ungroup them
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > double click to edit a group
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > adjusts z order when grouping
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > supports nested groups
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > updates fontSize & fontFamily appState
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > deselects selected element, on pointer up, when click hits element bounding box but doesn't hit the element
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > switches selected element on pointer down
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > can drag element that covers another element, while another elem is selected
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > deselects selected element on pointer down when pointer doesn't hit any element
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > Drags selected element when hitting only bounding box and keeps element selected
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > given selected element A with lower z-index than unselected element B and given B is partially over A when clicking intersection between A and B B should be selected on pointer up
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > given selected element A with lower z-index than unselected element B and given B is partially over A when dragging on intersection between A and B A should be dragged and keep being selected
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > deselects group of selected elements on pointer down when pointer doesn't hit any element
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > switches from group of selected elements to another element on pointer down
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > deselects group of selected elements on pointer up when pointer hits common bounding box without hitting any element
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > drags selected elements from point inside common bounding box that doesn't hit any element and keeps elements selected after dragging
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > given a group of selected elements with an element that is not selected inside the group common bounding box when element that is not selected is clicked should switch selection to not selected element on pointer up
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > given a selected element A and a not selected element B with higher z-index than A and given B partially overlaps A when there's a shift-click on the overlapped section B is added to the selection
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > shift click on selected element should deselect it on pointer up
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > single-clicking on a subgroup of a selected group should not alter selection
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > deleting last but one element in editing group should unselect the group
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > Cmd/Ctrl-click exclusively select element under pointer
TypeError: localStorage.clear is not a function
 ❯ packages/excalidraw/tests/regressionTests.test.tsx:59:16
     57|   unmountComponent();
     58| 
     59|   localStorage.clear();
       |                ^
     60|   renderStaticScene.mockClear();
     61|   reseed(7);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/392]⎯

 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > draw every type of shape
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > click to select a shape
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > key 2 selects rectangle tool
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > key r selects rectangle tool
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > key 3 selects diamond tool
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > key d selects diamond tool
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > key 4 selects ellipse tool
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > key o selects ellipse tool
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > key 5 selects arrow tool
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > key a selects arrow tool
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > key 6 selects line tool
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > key l selects line tool
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > key 7 selects freedraw tool
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > key p selects freedraw tool
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > change the properties of a shape
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > click on an element and drag it
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > alt-drag duplicates an element
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > click-drag to select a group
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > shift-click to multiselect, then drag
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > pinch-to-zoom works
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > two-finger scroll works
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > spacebar + drag scrolls the canvas
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > arrow keys
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > undo/redo drawing an element
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > noop interaction after undo shouldn't create history entry
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > zoom hotkeys
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > make a group and duplicate it
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > should group elements and ungroup them
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > double click to edit a group
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > adjusts z order when grouping
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > supports nested groups
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > updates fontSize & fontFamily appState
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > deselects selected element, on pointer up, when click hits element bounding box but doesn't hit the element
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > switches selected element on pointer down
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > can drag element that covers another element, while another elem is selected
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > deselects selected element on pointer down when pointer doesn't hit any element
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > Drags selected element when hitting only bounding box and keeps element selected
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > given selected element A with lower z-index than unselected element B and given B is partially over A when clicking intersection between A and B B should be selected on pointer up
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > given selected element A with lower z-index than unselected element B and given B is partially over A when dragging on intersection between A and B A should be dragged and keep being selected
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > deselects group of selected elements on pointer down when pointer doesn't hit any element
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > switches from group of selected elements to another element on pointer down
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > deselects group of selected elements on pointer up when pointer hits common bounding box without hitting any element
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > drags selected elements from point inside common bounding box that doesn't hit any element and keeps elements selected after dragging
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > given a group of selected elements with an element that is not selected inside the group common bounding box when element that is not selected is clicked should switch selection to not selected element on pointer up
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > given a selected element A and a not selected element B with higher z-index than A and given B partially overlaps A when there's a shift-click on the overlapped section B is added to the selection
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > shift click on selected element should deselect it on pointer up
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > single-clicking on a subgroup of a selected group should not alter selection
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > deleting last but one element in editing group should unselect the group
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > regression tests > Cmd/Ctrl-click exclusively select element under pointer
TypeError: Cannot read properties of undefined (reading 'length')
 ❯ checkpoint packages/excalidraw/tests/regressionTests.test.tsx:49:21
     47|   );
     48|   expect(h.state).toMatchSnapshot(`[${name}] appState`);
     49|   expect(h.elements.length).toMatchSnapshot(`[${name}] number of eleme…
       |                     ^
     50|   h.elements.forEach((element, i) =>
     51|     expect(element).toMatchSnapshot(`[${name}] element ${i}`),
 ❯ packages/excalidraw/tests/regressionTests.test.tsx:73:3

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/392]⎯

 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > given element A and group of elements B and given both are selected when user clicks on B, on pointer up only elements from B should be selected
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > given element A and group of elements B and given both are selected when user shift-clicks on B, on pointer up only element A should be selected
TypeError: localStorage.clear is not a function
 ❯ packages/excalidraw/tests/regressionTests.test.tsx:59:16
     57|   unmountComponent();
     58| 
     59|   localStorage.clear();
       |                ^
     60|   renderStaticScene.mockClear();
     61|   reseed(7);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/392]⎯

 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > given element A and group of elements B and given both are selected when user clicks on B, on pointer up only elements from B should be selected
 FAIL  packages/excalidraw/tests/regressionTests.test.tsx > given element A and group of elements B and given both are selected when user shift-clicks on B, on pointer up only element A should be selected
TypeError: Cannot read properties of undefined (reading 'length')
 ❯ checkpoint packages/excalidraw/tests/regressionTests.test.tsx:49:21
     47|   );
     48|   expect(h.state).toMatchSnapshot(`[${name}] appState`);
     49|   expect(h.elements.length).toMatchSnapshot(`[${name}] number of eleme…
       |                     ^
     50|   h.elements.forEach((element, i) =>
     51|     expect(element).toMatchSnapshot(`[${name}] element ${i}`),
 ❯ packages/excalidraw/tests/regressionTests.test.tsx:73:3

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/392]⎯

 FAIL  packages/excalidraw/tests/rotate.test.tsx > unselected bound arrow updates when rotating its target element
 FAIL  packages/excalidraw/tests/rotate.test.tsx > unselected bound arrows update when rotating their target elements
TypeError: localStorage.clear is not a function
 ❯ packages/excalidraw/tests/rotate.test.tsx:14:16
     12| 
     13| beforeEach(() => {
     14|   localStorage.clear();
       |                ^
     15|   reseed(7);
     16| });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/392]⎯

 FAIL  packages/excalidraw/tests/selection.test.tsx > box-selection > should allow adding to selection via box-select when holding shift
 FAIL  packages/excalidraw/tests/selection.test.tsx > box-selection > should (de)select element when box-selecting over and out while not holding shift
 FAIL  packages/excalidraw/tests/selection.test.tsx > inner box-selection > selecting elements visually nested inside another
 FAIL  packages/excalidraw/tests/selection.test.tsx > inner box-selection > selecting grouped elements visually nested inside another
 FAIL  packages/excalidraw/tests/selection.test.tsx > inner box-selection > selecting & deselecting grouped elements visually nested inside another
 FAIL  packages/excalidraw/tests/selection.test.tsx > selection element > create selection element on pointer down
 FAIL  packages/excalidraw/tests/selection.test.tsx > selection element > resize selection element on pointer move
 FAIL  packages/excalidraw/tests/selection.test.tsx > selection element > remove selection element on pointer up
 FAIL  packages/excalidraw/tests/selection.test.tsx > select single element on the scene > rectangle
 FAIL  packages/excalidraw/tests/selection.test.tsx > select single element on the scene > diamond
 FAIL  packages/excalidraw/tests/selection.test.tsx > select single element on the scene > ellipse
 FAIL  packages/excalidraw/tests/selection.test.tsx > select single element on the scene > arrow
 FAIL  packages/excalidraw/tests/selection.test.tsx > select single element on the scene > arrow escape
 FAIL  packages/excalidraw/tests/selection.test.tsx > tool locking & selection > should not select newly created element while tool is locked
 FAIL  packages/excalidraw/tests/selection.test.tsx > selectedElementIds stability > box-selection should be stable when not changing selection
TypeError: localStorage.clear is not a function
 ❯ packages/excalidraw/tests/selection.test.tsx:32:16
     30| 
     31| beforeEach(() => {
     32|   localStorage.clear();
       |                ^
     33|   renderInteractiveScene.mockClear();
     34|   renderStaticScene.mockClear();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/392]⎯

 FAIL  packages/excalidraw/components/Stats/stats.test.tsx > binding with linear elements > should remain bound to linear element on small position change
 FAIL  packages/excalidraw/components/Stats/stats.test.tsx > binding with linear elements > should unbind linear element on large position change
TypeError: localStorage.clear is not a function
 ❯ packages/excalidraw/components/Stats/stats.test.tsx:94:18
     92| describe("binding with linear elements", () => {
     93|   beforeEach(async () => {
     94|     localStorage.clear();
       |                  ^
     95|     renderStaticScene.mockClear();
     96|     reseed(19);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/392]⎯

 FAIL  packages/excalidraw/components/Stats/stats.test.tsx > stats for a generic element > should open stats
 FAIL  packages/excalidraw/components/Stats/stats.test.tsx > stats for a generic element > should be able to edit all properties for a general element
 FAIL  packages/excalidraw/components/Stats/stats.test.tsx > stats for a generic element > should keep only two decimal places
 FAIL  packages/excalidraw/components/Stats/stats.test.tsx > stats for a generic element > should update input x and y when angle is changed
 FAIL  packages/excalidraw/components/Stats/stats.test.tsx > stats for a generic element > should fix top left corner when width or height is changed
TypeError: localStorage.clear is not a function
 ❯ packages/excalidraw/components/Stats/stats.test.tsx:158:18
    156| describe("stats for a generic element", () => {
    157|   beforeEach(async () => {
    158|     localStorage.clear();
       |                  ^
    159|     renderStaticScene.mockClear();
    160|     reseed(7);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/392]⎯

 FAIL  packages/excalidraw/components/Stats/stats.test.tsx > stats for a non-generic element > text element
 FAIL  packages/excalidraw/components/Stats/stats.test.tsx > stats for a non-generic element > frame element
 FAIL  packages/excalidraw/components/Stats/stats.test.tsx > stats for a non-generic element > image element
 FAIL  packages/excalidraw/components/Stats/stats.test.tsx > stats for a non-generic element > should display fontSize for bound text
TypeError: localStorage.clear is not a function
 ❯ packages/excalidraw/components/Stats/stats.test.tsx:332:18
    330| describe("stats for a non-generic element", () => {
    331|   beforeEach(async () => {
    332|     localStorage.clear();
       |                  ^
    333|     renderStaticScene.mockClear();
    334|     reseed(7);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/392]⎯

 FAIL  packages/excalidraw/components/Stats/stats.test.tsx > stats for multiple elements > should display MIXED for elements with different values
 FAIL  packages/excalidraw/components/Stats/stats.test.tsx > stats for multiple elements > should display a property when one of the elements is editable for that property
 FAIL  packages/excalidraw/components/Stats/stats.test.tsx > stats for multiple elements > should treat groups as single units
TypeError: localStorage.clear is not a function
 ❯ packages/excalidraw/components/Stats/stats.test.tsx:490:18
    488|   beforeEach(async () => {
    489|     mouse.reset();
    490|     localStorage.clear();
       |                  ^
    491|     renderStaticScene.mockClear();
    492|     reseed(7);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[32/392]⎯

 FAIL  packages/excalidraw/components/Stats/stats.test.tsx > frame resizing behavior > should add shapes to frame when resizing frame to encompass them
 FAIL  packages/excalidraw/components/Stats/stats.test.tsx > frame resizing behavior > should add multiple shapes when frame encompasses them through height resize
 FAIL  packages/excalidraw/components/Stats/stats.test.tsx > frame resizing behavior > should not affect shapes that remain outside frame after resize
TypeError: localStorage.clear is not a function
 ❯ packages/excalidraw/components/Stats/stats.test.tsx:721:18
    719| describe("frame resizing behavior", () => {
    720|   beforeEach(async () => {
    721|     localStorage.clear();
       |                  ^
    722|     renderStaticScene.mockClear();
    723|     reseed(7);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[33/392]⎯


 Test Files  22 failed | 67 passed (89)
      Tests  323 failed | 709 passed | 46 skipped | 1 todo (1079)
   Start at  12:36:08
   Duration  15.78s (transform 8.52s, setup 22.08s, collect 152.13s, tests 69.15s, environment 88.51s, prepare 16.74s)

error Command failed with exit code 1.
info Visit https://yarnpkg.com/en/docs/cli/run for documentation about this command.
